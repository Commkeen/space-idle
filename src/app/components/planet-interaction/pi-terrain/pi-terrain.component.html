<div fxLayout="row" class="layout-container">
  <div fxFlex="100" class="layout-column-left">
    <div class="region-list">
      <div class="region" *ngFor="let region of regionList">
        <mat-divider></mat-divider>
        <div fxLayout="row" class="region-header">
          <div fxFlex="5">
            <fa-icon icon="cog"></fa-icon>
          </div>
          <div class="region-title" fxFlex="15">
            <div>{{region.name}}</div>
            <div><button *ngIf="region.canGather" (click)="gatherRegion(region.id)">Gather</button></div>
          </div>

          <div class="region-outpost" fxFlex="20" *ngIf="showOutpostPanel(region.id)">
            <div *ngIf="region.outpostLevel == 0">
              <button (click)="buyOutpost(region.id)">Build Outpost</button>
            </div>
            <div *ngIf="region.outpostLevel > 0">
              Outpost: {{region.outpostLevel}}
              <button (click)="buyOutpost(region.id)">Upgrade</button>
            </div>
            <div *ngIf="region.droneSlots > 0">
              <span>Drones: {{region.dronesAssigned}}/{{region.droneSlots}}</span>
              <button>-</button>
              <button>+</button>
            </div>
          </div>
          <div class="region-survey" fxFlex="50">
            <div fxLayout="row">
              <span *ngIf="region.surveyLevel == 0">Unsurveyed</span>
              <span *ngIf="region.surveyLevel > 0">Survey Lv {{region.surveyLevel}}</span>
              <app-progress-bar fxFlex="50" [value]="getSurveyProgress(region.id)" [max]="getSurveyProgressNeeded(region.id)"></app-progress-bar>
            </div>
            <div><button (click)="survey(region.id)">Survey</button></div>
          </div>
        </div>
        <mat-divider></mat-divider>
        <div class="region-content" fxLayout="row">
          <div class="feature-list">
            <div class="feature" fxLayout="row" *ngFor="let feature of region.features">
              <div class="feature-active" fxLayout="row" *ngIf="feature.active">
                <div class="feature-name" fxFlex="60">{{feature.name}}</div>
                <div class="feature-buttons" fxFlex="40">
                  <span class="ability" *ngFor="let ability of feature.abilities">
                    <button (click)="activateAbility(region.id, feature.id, ability.index)">{{ability.name}}</button>
                  </span>
                  <button *ngIf="feature.canGather" (click)="gatherFeature(region.id, feature.id)">Gather</button>
                </div>
              </div>
              <div class="feature-hidden" *ngIf="feature.hintActive">
                ---{{feature.surveyNeeded}}---
              </div>
            </div>
          </div>
        </div>
        <mat-divider></mat-divider>
      </div>
    </div>
  </div>
</div>
